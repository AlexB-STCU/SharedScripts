[{"uri":"/Test-NCrontab.html","title":"NCrontab Schedule Test\r\n","content":"(**\nNCrontab Schedule Test\n======================\n\nReturns a sampling of the next several date \u0026 times scheduled by an NCrontab string.\n\nUsage\n-----\n\n### Interactive\n\n\u0060\u0060\u0060cmd\ndotnet fsi .\\Test-NCrontab.fsx\n\u0060\u0060\u0060\n\n### Single test, with optional example count\n\n\u0060\u0060\u0060cmd\ndotnet fsi .\\Test-NCrontab.fsx \u00220 20 29 2 Mon\u0022 42\n\u0060\u0060\u0060\n*)\n#r \u0022nuget: NCrontab\u0022\nopen System\nlet testNCrontab n s =\n    let cron = NCrontab.CrontabSchedule.Parse(s)\n    let times = Seq.unfold (fun d -\u003E match cron.GetNextOccurrence(d) with | x -\u003E Some(x,x)) DateTime.Now\n    Seq.take n times |\u003E Seq.iter (printfn \u0022%O\u0022)\nlet readNCrontab () =\n    printf \u0022ncrontab\u003E \u0022\n    match Console.ReadLine () with\n    | \u0022quit\u0022 | \u0022q\u0022 -\u003E false\n    | s -\u003E\n        testNCrontab 20 s\n        true\nif fsi.CommandLineArgs.Length \u003C 2 then\n    while readNCrontab () do ()\nelse\n    let n = match Int32.TryParse(Array.tryItem 2 fsi.CommandLineArgs |\u003E Option.defaultValue \u0022\u0022) with | false,_ -\u003E 20 | true,n -\u003E n\n    Array.get fsi.CommandLineArgs 1 |\u003E testNCrontab n"},{"uri":"/USFederalHolidays.html","title":"US Federal Holiday Detection\r\n","content":"(**\nUS Federal Holiday Detection\n============================\n\nHere\u0027s how to determine whether a date is a US federal holiday using F#.\nYou probably want to curry the first two boolean parameters with the appropriate settings\n(some departments observe Sunday holidays on Monday, and some observe Saturday holidays on Friday).\n*)\nopen System\n\nlet getHoliday sunToMon satToFri (date:DateTime) =\n   match date.Month, date.Day, (date.Day-1)/7\u002B1, date.DayOfWeek with\n   | 1, 1, _, _ -\u003E \u0022New Year\u0027s Day\u0022\n   | 1, 2, _, DayOfWeek.Monday when sunToMon -\u003E \u0022New Year\u0027s Day (observed)\u0022\n   | 1, _, 3, DayOfWeek.Monday -\u003E \u0022Martin Luther King, Jr. Day\u0022\n   | 2, _, 3, DayOfWeek.Monday -\u003E \u0022Presidents Day\u0022\n   | 5, d, _, DayOfWeek.Monday when d \u003E= 25 -\u003E \u0022Memorial Day\u0022 // active pattern matching!\n   | 6, 18, _, DayOfWeek.Friday when satToFri -\u003E \u0022Juneteenth (observed)\u0022\n   | 6, 19, _, _ -\u003E \u0022Juneteenth Day\u0022\n   | 6, 20, _, DayOfWeek.Monday when sunToMon -\u003E \u0022Juneteenth Day (observed)\u0022\n   | 7, 3, _, DayOfWeek.Friday when satToFri -\u003E \u0022Independence Day (observed)\u0022\n   | 7, 4, _, _ -\u003E \u0022Independence Day\u0022\n   | 7, 5, _, DayOfWeek.Monday when sunToMon -\u003E \u0022Independence Day (observed)\u0022\n   | 9, _, 1, DayOfWeek.Monday -\u003E \u0022Labor Day\u0022\n   | 10, _, 2, DayOfWeek.Monday -\u003E \u0022Columbus Day\u0022\n   | 11, 10, _, DayOfWeek.Friday when satToFri -\u003E \u0022Veterans Day (observed)\u0022\n   | 11, 11, _, _ -\u003E \u0022Veterans Day\u0022\n   | 11, 12, _, DayOfWeek.Monday when sunToMon -\u003E \u0022Veterans Day (observed)\u0022\n   | 11, _, 4, DayOfWeek.Thursday -\u003E \u0022Thanksgiving Day\u0022\n   | 12, 24, _, DayOfWeek.Friday when satToFri -\u003E \u0022Christmas Day (observed)\u0022\n   | 12, 25, _, _ -\u003E \u0022Christmas Day\u0022\n   | 12, 26, _, DayOfWeek.Monday when sunToMon -\u003E \u0022Christmas Day (observed)\u0022\n   | 12, 31, _, DayOfWeek.Friday when satToFri -\u003E \u0022New Year\u0027s Day (observed)\u0022\n   | _ -\u003E null"}]