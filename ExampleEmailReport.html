<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>ExampleEmailReport.fsx
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">

    <link type="text/css" rel="stylesheet" href="fsxfmt/style.css" />
    <script type="text/javascript" src="fsxfmt/tips.js"></script>
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="span9" id="main">
          <h1>ExampleEmailReport.fsx</h1>
<p>Builds a chart and attaches it to an email, then sends it.</p>
<p><img src="http://rawgit.com/brianary/scripts/master/ExampleEmailReport.png" alt="chart email" /></p>
<h2>Namespaces &amp; References</h2>
<p>Declare CLR library usage.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">System</span>
<span class="c">// Needed to send an email with the charts.</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 2)" onmouseover="showTip(event, 'fs1', 2)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 3)" onmouseover="showTip(event, 'fs2', 3)" class="i">Net</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 4)" onmouseover="showTip(event, 'fs3', 4)" class="i">Mail</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 5)" onmouseover="showTip(event, 'fs1', 5)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 6)" onmouseover="showTip(event, 'fs2', 6)" class="i">Net</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs4', 7)" onmouseover="showTip(event, 'fs4', 7)" class="i">Mime</span>
<span class="c">// Needed for FSharp.Charting&#39;s ShowChart() method.</span>
<span class="prep">#r</span> <span class="s">&quot;System.Windows.Forms.DataVisualization&quot;</span>
</code></pre></td>
</tr>
</table>
<h2>Packages</h2>
<p>Download Paket if missing, then install NuGet packages using Paket, then reference and open package libraries.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="prep">#I</span> <span class="k">__SOURCE_DIRECTORY__</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs5', 8)" onmouseover="showTip(event, 'fs5', 8)" class="i">``paket.exe``</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs6', 9)" onmouseover="showTip(event, 'fs6', 9)" class="i">IO</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 10)" onmouseover="showTip(event, 'fs7', 10)" class="t">Path</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 11)" onmouseover="showTip(event, 'fs8', 11)" class="f">Combine</span>(<span class="k">__SOURCE_DIRECTORY__</span>,<span class="s">&quot;paket.exe&quot;</span>)
<span class="k">if</span> <span onmouseout="hideTip(event, 'fs9', 12)" onmouseover="showTip(event, 'fs9', 12)" class="f">not</span> (<span onmouseout="hideTip(event, 'fs6', 13)" onmouseover="showTip(event, 'fs6', 13)" class="i">IO</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 14)" onmouseover="showTip(event, 'fs10', 14)" class="t">File</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs11', 15)" onmouseover="showTip(event, 'fs11', 15)" class="f">Exists</span> <span onmouseout="hideTip(event, 'fs5', 16)" onmouseover="showTip(event, 'fs5', 16)" class="i">``paket.exe``</span>) <span class="k">then</span>
    <span class="k">use</span> <span onmouseout="hideTip(event, 'fs12', 17)" onmouseover="showTip(event, 'fs12', 17)" class="i">wc</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs2', 18)" onmouseover="showTip(event, 'fs2', 18)" class="i">Net</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 19)" onmouseover="showTip(event, 'fs13', 19)" class="t">WebClient</span>()
    <span onmouseout="hideTip(event, 'fs12', 20)" onmouseover="showTip(event, 'fs12', 20)" class="i">wc</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs14', 21)" onmouseover="showTip(event, 'fs14', 21)" class="f">DownloadFile</span>(<span onmouseout="hideTip(event, 'fs12', 22)" onmouseover="showTip(event, 'fs12', 22)" class="i">wc</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs15', 23)" onmouseover="showTip(event, 'fs15', 23)" class="f">DownloadString</span>(<span class="s">&quot;http://fsprojects.github.io/Paket/stable&quot;</span>),<span onmouseout="hideTip(event, 'fs5', 24)" onmouseover="showTip(event, 'fs5', 24)" class="i">``paket.exe``</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs16', 25)" onmouseover="showTip(event, 'fs16', 25)" class="i">``paket.dependencies``</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs6', 26)" onmouseover="showTip(event, 'fs6', 26)" class="i">IO</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 27)" onmouseover="showTip(event, 'fs7', 27)" class="t">Path</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 28)" onmouseover="showTip(event, 'fs8', 28)" class="f">Combine</span>(<span class="k">__SOURCE_DIRECTORY__</span>,<span class="s">&quot;paket.dependencies&quot;</span>)
<span class="k">if</span> <span onmouseout="hideTip(event, 'fs9', 29)" onmouseover="showTip(event, 'fs9', 29)" class="f">not</span> (<span onmouseout="hideTip(event, 'fs6', 30)" onmouseover="showTip(event, 'fs6', 30)" class="i">IO</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 31)" onmouseover="showTip(event, 'fs10', 31)" class="t">File</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs11', 32)" onmouseover="showTip(event, 'fs11', 32)" class="f">Exists</span> <span onmouseout="hideTip(event, 'fs16', 33)" onmouseover="showTip(event, 'fs16', 33)" class="i">``paket.dependencies``</span>) <span class="k">then</span>
    <span onmouseout="hideTip(event, 'fs6', 34)" onmouseover="showTip(event, 'fs6', 34)" class="i">IO</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 35)" onmouseover="showTip(event, 'fs10', 35)" class="t">File</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 36)" onmouseover="showTip(event, 'fs17', 36)" class="f">WriteAllLines</span>(<span onmouseout="hideTip(event, 'fs16', 37)" onmouseover="showTip(event, 'fs16', 37)" class="i">``paket.dependencies``</span>,[<span class="s">&quot;source https://nuget.org/api/v2&quot;</span>])
<span class="prep">#r</span> <span class="s">&quot;paket.exe&quot;</span>
<span class="k">open</span> <span class="i">Paket</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs18', 38)" onmouseover="showTip(event, 'fs18', 38)" class="i">dependencies</span> <span class="o">=</span> <span class="i">Dependencies</span><span class="o">.</span><span class="i">Locate</span>(<span class="k">__SOURCE_DIRECTORY__</span>)
<span onmouseout="hideTip(event, 'fs18', 39)" onmouseover="showTip(event, 'fs18', 39)" class="i">dependencies</span><span class="o">.</span><span class="i">Add</span> <span class="s">&quot;FSharp.Data.SqlClient&quot;</span>
<span onmouseout="hideTip(event, 'fs18', 40)" onmouseover="showTip(event, 'fs18', 40)" class="i">dependencies</span><span class="o">.</span><span class="i">Add</span> <span class="s">&quot;FSharp.Charting&quot;</span>
<span onmouseout="hideTip(event, 'fs18', 41)" onmouseover="showTip(event, 'fs18', 41)" class="i">dependencies</span><span class="o">.</span><span class="i">Restore</span>()

<span class="prep">#I</span> <span class="s">@&quot;packages\FSharp.Data.SqlClient\lib\net40&quot;</span>
<span class="prep">#r</span> <span class="s">&quot;FSharp.Data.SqlClient&quot;</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs19', 42)" onmouseover="showTip(event, 'fs19', 42)" class="i">FSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 43)" onmouseover="showTip(event, 'fs20', 43)" class="i">Data</span>
<span class="prep">#I</span> <span class="s">@&quot;packages\FSharp.Charting\lib\net40&quot;</span>
<span class="prep">#r</span> <span class="s">&quot;FSharp.Charting&quot;</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs19', 44)" onmouseover="showTip(event, 'fs19', 44)" class="i">FSharp</span><span class="o">.</span><span class="i">Charting</span>
</code></pre></td>
</tr>
</table>
<h2>Database</h2>
<p>Install the AdventureWorks2014 database from
<a href="https://msftdbprodsamples.codeplex.com/releases/view/125550">https://msftdbprodsamples.codeplex.com/releases/view/125550</a> .
With VS installed, you should be able to unzip
<strong>Adventure Works 2014 OLTP Script.zip</strong> into
<em>C:\Program Files\Microsoft SQL Server\120\Tools\Samples\Adventure Works 2014 OLTP Script</em>
(depending on version) then run something like
<code>sqlcmd.exe -E -S "(localdb)\ProjectV12" -i instawdb.sql</code>
(from that directory, running in a PowerShell or cmd prompt as admin).</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">/// Use the SQL Server Type Provider to define a type-safe query for the top products (by $ amount)</span>
<span class="c">/// summary order amount statistics by date.</span>
[&lt;<span onmouseout="hideTip(event, 'fs21', 45)" onmouseover="showTip(event, 'fs21', 45)" class="t">Literal</span>&gt;]
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs22', 46)" onmouseover="showTip(event, 'fs22', 46)" class="i">ConnStr</span> <span class="o">=</span> <span class="s">&quot;server=(localdb)\ProjectsV13;database=AdventureWorks2014;integrated security=SSPI&quot;</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs23', 47)" onmouseover="showTip(event, 'fs23', 47)" class="t">OrderCmd</span> <span class="o">=</span> <span class="i">SqlCommandProvider</span><span class="o">&lt;</span><span class="s">&quot;</span>
<span class="s">select p.Name, p.ProductID, o.OrderDate, sum(od.LineTotal) Total, </span>
<span class="s">       min(od.LineTotal) MinAmt, max(od.LineTotal) MaxAmt, </span>
<span class="s">       avg(od.LineTotal) AvgAmt, coalesce(stdev(od.LineTotal),0.0) StDevAmt, </span>
<span class="s">       (max(od.LineTotal) - min(od.LineTotal)) / 2 + min(od.LineTotal) MedianAmt</span>
<span class="s">  from Production.Product p</span>
<span class="s">  join Sales.SalesOrderDetail od</span>
<span class="s">    on p.ProductID = od.ProductID</span>
<span class="s">  join Sales.SalesOrderHeader o</span>
<span class="s">    on od.SalesOrderID = o.SalesOrderID</span>
<span class="s"> where p.ProductID in (select top 5 pod.ProductID from Sales.SalesOrderDetail pod </span>
<span class="s">       group by pod.ProductID order by sum(pod.LineTotal) desc)</span>
<span class="s">   and o.OrderDate between &#39;2014-03-01&#39; and &#39;2014-03-31&#39;</span>
<span class="s"> group by p.ProductID, p.Name, o.OrderDate</span>
<span class="s"> order by p.ProductID, o.OrderDate</span>
<span class="s">&quot;</span>,<span onmouseout="hideTip(event, 'fs22', 48)" onmouseover="showTip(event, 'fs22', 48)" class="i">ConnStr</span><span class="o">&gt;</span>
<span class="c">/// An instance of the query type.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs24', 49)" onmouseover="showTip(event, 'fs24', 49)" class="i">getOrders</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs23', 50)" onmouseover="showTip(event, 'fs23', 50)" class="t">OrderCmd</span>(<span onmouseout="hideTip(event, 'fs22', 51)" onmouseover="showTip(event, 'fs22', 51)" class="i">ConnStr</span>)
</code></pre></td>
</tr>
</table>
<h2>Manipulate Data</h2>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">/// Converts a product name, record sequence tuple into a product name, sum total amount tuple.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs25', 52)" onmouseover="showTip(event, 'fs25', 52)" class="f">productTotal</span> (<span onmouseout="hideTip(event, 'fs26', 53)" onmouseover="showTip(event, 'fs26', 53)" class="i">n</span>,<span onmouseout="hideTip(event, 'fs27', 54)" onmouseover="showTip(event, 'fs27', 54)" class="i">p</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs23', 55)" onmouseover="showTip(event, 'fs23', 55)" class="i">OrderCmd</span><span class="o">.</span><span class="i">Record</span> <span onmouseout="hideTip(event, 'fs28', 56)" onmouseover="showTip(event, 'fs28', 56)" class="t">seq</span>) <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs26', 57)" onmouseover="showTip(event, 'fs26', 57)" class="i">n</span>, <span onmouseout="hideTip(event, 'fs29', 58)" onmouseover="showTip(event, 'fs29', 58)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs30', 59)" onmouseover="showTip(event, 'fs30', 59)" class="f">sumBy</span> (<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs31', 60)" onmouseover="showTip(event, 'fs31', 60)" class="i">d</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs23', 61)" onmouseover="showTip(event, 'fs23', 61)" class="i">OrderCmd</span><span class="o">.</span><span class="i">Record</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs31', 62)" onmouseover="showTip(event, 'fs31', 62)" class="i">d</span><span class="o">.</span><span class="i">Total</span><span class="o">.</span><span class="i">Value</span>) <span onmouseout="hideTip(event, 'fs27', 63)" onmouseover="showTip(event, 'fs27', 63)" class="i">p</span>
<span class="c">/// Converts a record into a date, max amount tuple if it differs from the average amount.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs32', 64)" onmouseover="showTip(event, 'fs32', 64)" class="f">dateMax</span> <span class="o">=</span> 
    <span class="k">function</span> 
    | (<span onmouseout="hideTip(event, 'fs33', 65)" onmouseover="showTip(event, 'fs33', 65)" class="i">d</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs23', 66)" onmouseover="showTip(event, 'fs23', 66)" class="i">OrderCmd</span><span class="o">.</span><span class="i">Record</span>) <span class="k">when</span> <span onmouseout="hideTip(event, 'fs33', 67)" onmouseover="showTip(event, 'fs33', 67)" class="i">d</span><span class="o">.</span><span class="i">MaxAmt</span><span class="o">.</span><span class="i">Value</span> <span class="o">&lt;&gt;</span> <span onmouseout="hideTip(event, 'fs33', 68)" onmouseover="showTip(event, 'fs33', 68)" class="i">d</span><span class="o">.</span><span class="i">AvgAmt</span><span class="o">.</span><span class="i">Value</span> 
        <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs34', 69)" onmouseover="showTip(event, 'fs34', 69)" class="p">Some</span> (<span onmouseout="hideTip(event, 'fs33', 70)" onmouseover="showTip(event, 'fs33', 70)" class="i">d</span><span class="o">.</span><span class="i">OrderDate</span>, <span onmouseout="hideTip(event, 'fs33', 71)" onmouseover="showTip(event, 'fs33', 71)" class="i">d</span><span class="o">.</span><span class="i">MaxAmt</span><span class="o">.</span><span class="i">Value</span>) 
    | _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs35', 72)" onmouseover="showTip(event, 'fs35', 72)" class="p">None</span>
<span class="c">/// Converts a record into a date, standard deviation of amount tuple if one exists.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs36', 73)" onmouseover="showTip(event, 'fs36', 73)" class="f">dateStDev</span> <span class="o">=</span> 
    <span class="k">function</span> 
    | (<span onmouseout="hideTip(event, 'fs33', 74)" onmouseover="showTip(event, 'fs33', 74)" class="i">d</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs23', 75)" onmouseover="showTip(event, 'fs23', 75)" class="i">OrderCmd</span><span class="o">.</span><span class="i">Record</span>) <span class="k">when</span> <span onmouseout="hideTip(event, 'fs33', 76)" onmouseover="showTip(event, 'fs33', 76)" class="i">d</span><span class="o">.</span><span class="i">StDevAmt</span><span class="o">.</span><span class="i">Value</span> <span class="o">&lt;&gt;</span> <span class="n">0.0</span> 
        <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs34', 77)" onmouseover="showTip(event, 'fs34', 77)" class="p">Some</span> (<span onmouseout="hideTip(event, 'fs33', 78)" onmouseover="showTip(event, 'fs33', 78)" class="i">d</span><span class="o">.</span><span class="i">OrderDate</span>, <span onmouseout="hideTip(event, 'fs37', 79)" onmouseover="showTip(event, 'fs37', 79)" class="f">float</span> <span onmouseout="hideTip(event, 'fs33', 80)" onmouseover="showTip(event, 'fs33', 80)" class="i">d</span><span class="o">.</span><span class="i">AvgAmt</span><span class="o">.</span><span class="i">Value</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs33', 81)" onmouseover="showTip(event, 'fs33', 81)" class="i">d</span><span class="o">.</span><span class="i">StDevAmt</span><span class="o">.</span><span class="i">Value</span>) 
    | _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs35', 82)" onmouseover="showTip(event, 'fs35', 82)" class="p">None</span>
<span class="c">/// Converts a record into a date, average amount tuple.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs38', 83)" onmouseover="showTip(event, 'fs38', 83)" class="f">dateAvg</span> (<span onmouseout="hideTip(event, 'fs33', 84)" onmouseover="showTip(event, 'fs33', 84)" class="i">d</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs23', 85)" onmouseover="showTip(event, 'fs23', 85)" class="i">OrderCmd</span><span class="o">.</span><span class="i">Record</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs33', 86)" onmouseover="showTip(event, 'fs33', 86)" class="i">d</span><span class="o">.</span><span class="i">OrderDate</span>, <span onmouseout="hideTip(event, 'fs33', 87)" onmouseover="showTip(event, 'fs33', 87)" class="i">d</span><span class="o">.</span><span class="i">AvgAmt</span><span class="o">.</span><span class="i">Value</span>

<span class="c">/// Collects the records by product name, caching to prevent re-reading from a closed data reader.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs39', 88)" onmouseover="showTip(event, 'fs39', 88)" class="i">products</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs24', 89)" onmouseover="showTip(event, 'fs24', 89)" class="i">getOrders</span><span class="o">.</span><span class="i">Execute</span>() <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs29', 90)" onmouseover="showTip(event, 'fs29', 90)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 91)" onmouseover="showTip(event, 'fs40', 91)" class="f">cache</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs29', 92)" onmouseover="showTip(event, 'fs29', 92)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs41', 93)" onmouseover="showTip(event, 'fs41', 93)" class="f">groupBy</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs42', 94)" onmouseover="showTip(event, 'fs42', 94)" class="i">o</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs42', 95)" onmouseover="showTip(event, 'fs42', 95)" class="i">o</span><span class="o">.</span><span class="i">Name</span>)

<span class="c">/// Saves a chart to a temporary file, and returns a LinkedResource object for emailing.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs43', 96)" onmouseover="showTip(event, 'fs43', 96)" class="f">saveChart</span> (<span onmouseout="hideTip(event, 'fs44', 97)" onmouseover="showTip(event, 'fs44', 97)" class="i">c</span><span class="o">:</span><span class="i">ChartTypes</span><span class="o">.</span><span class="i">GenericChart</span>) <span class="o">=</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs45', 98)" onmouseover="showTip(event, 'fs45', 98)" class="i">file</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs6', 99)" onmouseover="showTip(event, 'fs6', 99)" class="i">IO</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 100)" onmouseover="showTip(event, 'fs7', 100)" class="t">Path</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs46', 101)" onmouseover="showTip(event, 'fs46', 101)" class="f">ChangeExtension</span>(<span onmouseout="hideTip(event, 'fs6', 102)" onmouseover="showTip(event, 'fs6', 102)" class="i">IO</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 103)" onmouseover="showTip(event, 'fs7', 103)" class="t">Path</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs47', 104)" onmouseover="showTip(event, 'fs47', 104)" class="f">GetTempFileName</span>(),<span class="s">&quot;png&quot;</span>)
    <span class="c">// Needed to render to file. This is a workaround for bug #38</span>
    <span class="c">// see https://github.com/fsharp/FSharp.Charting/issues/38</span>
    <span class="c">// (This will display a window with the chart.)</span>
    <span onmouseout="hideTip(event, 'fs44', 105)" onmouseover="showTip(event, 'fs44', 105)" class="i">c</span><span class="o">.</span><span class="i">ShowChart</span>() <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs48', 106)" onmouseover="showTip(event, 'fs48', 106)" class="f">ignore</span>
    <span onmouseout="hideTip(event, 'fs44', 107)" onmouseover="showTip(event, 'fs44', 107)" class="i">c</span><span class="o">.</span><span class="i">SaveChartAs</span>(<span onmouseout="hideTip(event, 'fs45', 108)" onmouseover="showTip(event, 'fs45', 108)" class="i">file</span>,<span class="i">ChartTypes</span><span class="o">.</span><span class="i">ChartImageFormat</span><span class="o">.</span><span class="i">Png</span>)
    <span class="k">new</span> <span onmouseout="hideTip(event, 'fs49', 109)" onmouseover="showTip(event, 'fs49', 109)" class="t">LinkedResource</span>(<span onmouseout="hideTip(event, 'fs45', 110)" onmouseover="showTip(event, 'fs45', 110)" class="i">file</span>,<span class="s">&quot;image/png&quot;</span>)
</code></pre></td>
</tr>
</table>
<h2>Charts</h2>
<p>For each product, build a compound chart, then append those to a list containing the
summary pie chart, and save them all for emailing.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">/// The collection of charts, as LinkResource objects for emailing.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs50', 111)" onmouseover="showTip(event, 'fs50', 111)" class="i">charts</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs39', 112)" onmouseover="showTip(event, 'fs39', 112)" class="i">products</span> 
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs29', 113)" onmouseover="showTip(event, 'fs29', 113)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs51', 114)" onmouseover="showTip(event, 'fs51', 114)" class="f">toList</span>
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs52', 115)" onmouseover="showTip(event, 'fs52', 115)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs53', 116)" onmouseover="showTip(event, 'fs53', 116)" class="f">map</span> 
            (<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs54', 117)" onmouseover="showTip(event, 'fs54', 117)" class="i">p</span>,<span onmouseout="hideTip(event, 'fs55', 118)" onmouseover="showTip(event, 'fs55', 118)" class="i">o</span>) <span class="k">-&gt;</span> 
                <span class="i">Chart</span><span class="o">.</span><span class="i">Combine</span>(<span class="i">charts</span><span class="o">=</span>
                    [ <span class="i">Chart</span><span class="o">.</span><span class="i">Point</span>(<span class="i">Title</span><span class="o">=</span><span onmouseout="hideTip(event, 'fs54', 119)" onmouseover="showTip(event, 'fs54', 119)" class="i">p</span>,<span class="i">Color</span><span class="o">=</span><span onmouseout="hideTip(event, 'fs56', 120)" onmouseover="showTip(event, 'fs56', 120)" class="i">Drawing</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs57', 121)" onmouseover="showTip(event, 'fs57', 121)" class="i">Color</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs58', 122)" onmouseover="showTip(event, 'fs58', 122)" class="i">Red</span>,
                        <span class="i">data</span><span class="o">=</span><span onmouseout="hideTip(event, 'fs29', 123)" onmouseover="showTip(event, 'fs29', 123)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs59', 124)" onmouseover="showTip(event, 'fs59', 124)" class="i">choose</span> <span onmouseout="hideTip(event, 'fs32', 125)" onmouseover="showTip(event, 'fs32', 125)" class="i">dateMax</span> <span onmouseout="hideTip(event, 'fs55', 126)" onmouseover="showTip(event, 'fs55', 126)" class="i">o</span>)
                      <span class="i">Chart</span><span class="o">.</span><span class="i">Point</span>(<span class="i">Color</span><span class="o">=</span><span onmouseout="hideTip(event, 'fs56', 127)" onmouseover="showTip(event, 'fs56', 127)" class="i">Drawing</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs57', 128)" onmouseover="showTip(event, 'fs57', 128)" class="i">Color</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs60', 129)" onmouseover="showTip(event, 'fs60', 129)" class="i">DarkOrange</span>,
                        <span class="i">data</span><span class="o">=</span><span onmouseout="hideTip(event, 'fs29', 130)" onmouseover="showTip(event, 'fs29', 130)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs59', 131)" onmouseover="showTip(event, 'fs59', 131)" class="i">choose</span> <span onmouseout="hideTip(event, 'fs36', 132)" onmouseover="showTip(event, 'fs36', 132)" class="i">dateStDev</span> <span onmouseout="hideTip(event, 'fs55', 133)" onmouseover="showTip(event, 'fs55', 133)" class="i">o</span>)
                      <span class="i">Chart</span><span class="o">.</span><span class="i">Column</span>(<span class="i">Color</span><span class="o">=</span><span onmouseout="hideTip(event, 'fs56', 134)" onmouseover="showTip(event, 'fs56', 134)" class="i">Drawing</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs57', 135)" onmouseover="showTip(event, 'fs57', 135)" class="i">Color</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs61', 136)" onmouseover="showTip(event, 'fs61', 136)" class="i">Blue</span>,
                        <span class="i">data</span><span class="o">=</span><span onmouseout="hideTip(event, 'fs29', 137)" onmouseover="showTip(event, 'fs29', 137)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs62', 138)" onmouseover="showTip(event, 'fs62', 138)" class="i">map</span> <span onmouseout="hideTip(event, 'fs38', 139)" onmouseover="showTip(event, 'fs38', 139)" class="i">dateAvg</span> <span onmouseout="hideTip(event, 'fs55', 140)" onmouseover="showTip(event, 'fs55', 140)" class="i">o</span>) ]))
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs52', 141)" onmouseover="showTip(event, 'fs52', 141)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs63', 142)" onmouseover="showTip(event, 'fs63', 142)" class="f">append</span> 
            [<span class="i">Chart</span><span class="o">.</span><span class="i">Pie</span>(<span class="i">Title</span><span class="o">=</span><span class="s">&quot;Top 5 Products, March 2014&quot;</span>,
                <span class="i">data</span><span class="o">=</span><span onmouseout="hideTip(event, 'fs29', 143)" onmouseover="showTip(event, 'fs29', 143)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs62', 144)" onmouseover="showTip(event, 'fs62', 144)" class="i">map</span> <span onmouseout="hideTip(event, 'fs25', 145)" onmouseover="showTip(event, 'fs25', 145)" class="i">productTotal</span> <span onmouseout="hideTip(event, 'fs39', 146)" onmouseover="showTip(event, 'fs39', 146)" class="i">products</span>)]
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs52', 147)" onmouseover="showTip(event, 'fs52', 147)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs53', 148)" onmouseover="showTip(event, 'fs53', 148)" class="f">map</span> <span onmouseout="hideTip(event, 'fs43', 149)" onmouseover="showTip(event, 'fs43', 149)" class="f">saveChart</span>
</code></pre></td>
</tr>
</table>
<h2>Attach Chart to Email</h2>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">/// Sends an email to the given address, with the given subject, using the LinkedResource </span>
<span class="c">/// objects as inline images in the body of the message.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs64', 150)" onmouseover="showTip(event, 'fs64', 150)" class="f">sendCharts</span> (<span onmouseout="hideTip(event, 'fs65', 151)" onmouseover="showTip(event, 'fs65', 151)" class="i">t</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs66', 152)" onmouseover="showTip(event, 'fs66', 152)" class="t">string</span>) <span onmouseout="hideTip(event, 'fs67', 153)" onmouseover="showTip(event, 'fs67', 153)" class="i">s</span> <span onmouseout="hideTip(event, 'fs68', 154)" onmouseover="showTip(event, 'fs68', 154)" class="i">c</span> <span class="o">=</span>
    <span class="c">/// The email message, initialized with the subject value.</span>
    <span class="c">/// The default from address is set in machine.config&#39;s</span>
    <span class="c">/// /configuration/system.net/mailSettings/smtp/@from</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs69', 155)" onmouseover="showTip(event, 'fs69', 155)" class="i">email</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs70', 156)" onmouseover="showTip(event, 'fs70', 156)" class="t">MailMessage</span>(<span class="i">Subject</span><span class="o">=</span><span onmouseout="hideTip(event, 'fs67', 157)" onmouseover="showTip(event, 'fs67', 157)" class="i">s</span>)
    <span onmouseout="hideTip(event, 'fs69', 158)" onmouseover="showTip(event, 'fs69', 158)" class="i">email</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs71', 159)" onmouseover="showTip(event, 'fs71', 159)" class="i">To</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs72', 160)" onmouseover="showTip(event, 'fs72', 160)" class="f">Add</span>(<span onmouseout="hideTip(event, 'fs65', 161)" onmouseover="showTip(event, 'fs65', 161)" class="i">t</span>)
    <span class="c">/// The HTML body of the email: inline images of the provided LinkedResource objects.</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs73', 162)" onmouseover="showTip(event, 'fs73', 162)" class="i">body</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs52', 163)" onmouseover="showTip(event, 'fs52', 163)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs53', 164)" onmouseover="showTip(event, 'fs53', 164)" class="f">map</span> (<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs74', 165)" onmouseover="showTip(event, 'fs74', 165)" class="i">i</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs49', 166)" onmouseover="showTip(event, 'fs49', 166)" class="t">LinkedResource</span>) <span class="k">-&gt;</span> 
                    <span onmouseout="hideTip(event, 'fs75', 167)" onmouseover="showTip(event, 'fs75', 167)" class="f">sprintf</span> <span class="s">&quot;&lt;div&gt;&lt;img src=&#39;cid:</span><span class="pf">%s</span><span class="s">&#39; /&gt;&lt;/div&gt;&quot;</span> <span onmouseout="hideTip(event, 'fs74', 168)" onmouseover="showTip(event, 'fs74', 168)" class="i">i</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs76', 169)" onmouseover="showTip(event, 'fs76', 169)" class="i">ContentId</span>) <span onmouseout="hideTip(event, 'fs68', 170)" onmouseover="showTip(event, 'fs68', 170)" class="i">c</span> 
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs77', 171)" onmouseover="showTip(event, 'fs77', 171)" class="t">String</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs78', 172)" onmouseover="showTip(event, 'fs78', 172)" class="f">concat</span> <span class="s">&quot;</span><span class="e">\n</span><span class="s">&quot;</span>
    <span class="c">/// Create the body as an AlternateView object, to support inline images.</span>
    <span class="k">use</span> <span onmouseout="hideTip(event, 'fs79', 173)" onmouseover="showTip(event, 'fs79', 173)" class="i">view</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs80', 174)" onmouseover="showTip(event, 'fs80', 174)" class="t">AlternateView</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs81', 175)" onmouseover="showTip(event, 'fs81', 175)" class="f">CreateAlternateViewFromString</span>(<span onmouseout="hideTip(event, 'fs73', 176)" onmouseover="showTip(event, 'fs73', 176)" class="i">body</span>, 
            <span onmouseout="hideTip(event, 'fs82', 177)" onmouseover="showTip(event, 'fs82', 177)" class="t">ContentType</span> <span onmouseout="hideTip(event, 'fs83', 178)" onmouseover="showTip(event, 'fs83', 178)" class="t">MediaTypeNames</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs84', 179)" onmouseover="showTip(event, 'fs84', 179)" class="t">Text</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs85', 180)" onmouseover="showTip(event, 'fs85', 180)" class="i">Html</span>)
    <span onmouseout="hideTip(event, 'fs29', 181)" onmouseover="showTip(event, 'fs29', 181)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs86', 182)" onmouseover="showTip(event, 'fs86', 182)" class="f">iter</span> <span onmouseout="hideTip(event, 'fs79', 183)" onmouseover="showTip(event, 'fs79', 183)" class="i">view</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs87', 184)" onmouseover="showTip(event, 'fs87', 184)" class="i">LinkedResources</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs88', 185)" onmouseover="showTip(event, 'fs88', 185)" class="f">Add</span> <span onmouseout="hideTip(event, 'fs68', 186)" onmouseover="showTip(event, 'fs68', 186)" class="i">c</span>
    <span onmouseout="hideTip(event, 'fs69', 187)" onmouseover="showTip(event, 'fs69', 187)" class="i">email</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs89', 188)" onmouseover="showTip(event, 'fs89', 188)" class="i">AlternateViews</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs90', 189)" onmouseover="showTip(event, 'fs90', 189)" class="f">Add</span>(<span onmouseout="hideTip(event, 'fs79', 190)" onmouseover="showTip(event, 'fs79', 190)" class="i">view</span>)
    <span class="c">/// The SMTP sender, configured in the machine.config&#39;s</span>
    <span class="c">/// /configuration/system.net/mailSettings element.</span>
    <span class="k">use</span> <span onmouseout="hideTip(event, 'fs91', 191)" onmouseover="showTip(event, 'fs91', 191)" class="i">send</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs92', 192)" onmouseover="showTip(event, 'fs92', 192)" class="t">SmtpClient</span>()
    <span onmouseout="hideTip(event, 'fs91', 193)" onmouseover="showTip(event, 'fs91', 193)" class="i">send</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs93', 194)" onmouseover="showTip(event, 'fs93', 194)" class="f">Send</span>(<span onmouseout="hideTip(event, 'fs69', 195)" onmouseover="showTip(event, 'fs69', 195)" class="i">email</span>)
</code></pre></td>
</tr>
</table>
<h2>Send Email</h2>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs64', 196)" onmouseover="showTip(event, 'fs64', 196)" class="f">sendCharts</span> <span class="s">&quot;test@example.com&quot;</span> <span class="s">&quot;Top Products Charts&quot;</span> <span onmouseout="hideTip(event, 'fs50', 197)" onmouseover="showTip(event, 'fs50', 197)" class="i">charts</span>
</code></pre></td>
</tr>
</table>

        </div>
      </div>
    </div>
	<div class="tip" id="fs1">namespace System</div>
<div class="tip" id="fs2">namespace System.Net</div>
<div class="tip" id="fs3">namespace System.Net.Mail</div>
<div class="tip" id="fs4">namespace System.Net.Mime</div>
<div class="tip" id="fs5">val ( paket.exe ) : string<br /><br />Full name: ExampleEmailReport.( paket.exe )</div>
<div class="tip" id="fs6">namespace System.IO</div>
<div class="tip" id="fs7">type Path =<br />&#160;&#160;static val DirectorySeparatorChar : char<br />&#160;&#160;static val AltDirectorySeparatorChar : char<br />&#160;&#160;static val VolumeSeparatorChar : char<br />&#160;&#160;static val InvalidPathChars : char[]<br />&#160;&#160;static val PathSeparator : char<br />&#160;&#160;static member ChangeExtension : path:string * extension:string -&gt; string<br />&#160;&#160;static member Combine : [&lt;ParamArray&gt;] paths:string[] -&gt; string + 3 overloads<br />&#160;&#160;static member GetDirectoryName : path:string -&gt; string<br />&#160;&#160;static member GetExtension : path:string -&gt; string<br />&#160;&#160;static member GetFileName : path:string -&gt; string<br />&#160;&#160;...<br /><br />Full name: System.IO.Path</div>
<div class="tip" id="fs8">IO.Path.Combine([&lt;ParamArray&gt;] paths: string []) : string<br />IO.Path.Combine(path1: string, path2: string) : string<br />IO.Path.Combine(path1: string, path2: string, path3: string) : string<br />IO.Path.Combine(path1: string, path2: string, path3: string, path4: string) : string</div>
<div class="tip" id="fs9">val not : value:bool -&gt; bool<br /><br />Full name: Microsoft.FSharp.Core.Operators.not</div>
<div class="tip" id="fs10">type File =<br />&#160;&#160;static member AppendAllLines : path:string * contents:IEnumerable&lt;string&gt; -&gt; unit + 1 overload<br />&#160;&#160;static member AppendAllText : path:string * contents:string -&gt; unit + 1 overload<br />&#160;&#160;static member AppendText : path:string -&gt; StreamWriter<br />&#160;&#160;static member Copy : sourceFileName:string * destFileName:string -&gt; unit + 1 overload<br />&#160;&#160;static member Create : path:string -&gt; FileStream + 3 overloads<br />&#160;&#160;static member CreateText : path:string -&gt; StreamWriter<br />&#160;&#160;static member Decrypt : path:string -&gt; unit<br />&#160;&#160;static member Delete : path:string -&gt; unit<br />&#160;&#160;static member Encrypt : path:string -&gt; unit<br />&#160;&#160;static member Exists : path:string -&gt; bool<br />&#160;&#160;...<br /><br />Full name: System.IO.File</div>
<div class="tip" id="fs11">IO.File.Exists(path: string) : bool</div>
<div class="tip" id="fs12">val wc : Net.WebClient</div>
<div class="tip" id="fs13">Multiple items<br />type WebClient =<br />&#160;&#160;inherit Component<br />&#160;&#160;new : unit -&gt; WebClient<br />&#160;&#160;member BaseAddress : string with get, set<br />&#160;&#160;member CachePolicy : RequestCachePolicy with get, set<br />&#160;&#160;member CancelAsync : unit -&gt; unit<br />&#160;&#160;member Credentials : ICredentials with get, set<br />&#160;&#160;member DownloadData : address:string -&gt; byte[] + 1 overload<br />&#160;&#160;member DownloadDataAsync : address:Uri -&gt; unit + 1 overload<br />&#160;&#160;member DownloadFile : address:string * fileName:string -&gt; unit + 1 overload<br />&#160;&#160;member DownloadFileAsync : address:Uri * fileName:string -&gt; unit + 1 overload<br />&#160;&#160;member DownloadString : address:string -&gt; string + 1 overload<br />&#160;&#160;...<br /><br />Full name: System.Net.WebClient<br /><br />--------------------<br />Net.WebClient() : unit</div>
<div class="tip" id="fs14">Net.WebClient.DownloadFile(address: Uri, fileName: string) : unit<br />Net.WebClient.DownloadFile(address: string, fileName: string) : unit</div>
<div class="tip" id="fs15">Net.WebClient.DownloadString(address: Uri) : string<br />Net.WebClient.DownloadString(address: string) : string</div>
<div class="tip" id="fs16">val ( paket.dependencies ) : string<br /><br />Full name: ExampleEmailReport.( paket.dependencies )</div>
<div class="tip" id="fs17">IO.File.WriteAllLines(path: string, contents: Collections.Generic.IEnumerable&lt;string&gt;) : unit<br />IO.File.WriteAllLines(path: string, contents: string []) : unit<br />IO.File.WriteAllLines(path: string, contents: Collections.Generic.IEnumerable&lt;string&gt;, encoding: Text.Encoding) : unit<br />IO.File.WriteAllLines(path: string, contents: string [], encoding: Text.Encoding) : unit</div>
<div class="tip" id="fs18">val dependencies : obj<br /><br />Full name: ExampleEmailReport.dependencies</div>
<div class="tip" id="fs19">namespace Microsoft.FSharp</div>
<div class="tip" id="fs20">namespace Microsoft.FSharp.Data</div>
<div class="tip" id="fs21">Multiple items<br />type LiteralAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : unit -&gt; LiteralAttribute<br /><br />Full name: Microsoft.FSharp.Core.LiteralAttribute<br /><br />--------------------<br />new : unit -&gt; LiteralAttribute</div>
<div class="tip" id="fs22">val ConnStr : string<br /><br />Full name: ExampleEmailReport.ConnStr<br /><em><br /><br />&#160;Use the SQL Server Type Provider to define a type-safe query for the top products (by $ amount)<br />&#160;summary order amount statistics by date.</em></div>
<div class="tip" id="fs23">type OrderCmd = obj<br /><br />Full name: ExampleEmailReport.OrderCmd</div>
<div class="tip" id="fs24">val getOrders : OrderCmd<br /><br />Full name: ExampleEmailReport.getOrders<br /><em><br /><br />&#160;An instance of the query type.</em></div>
<div class="tip" id="fs25">val productTotal : n:&#39;a * p:seq&lt;&#39;b&gt; -&gt; &#39;a * obj<br /><br />Full name: ExampleEmailReport.productTotal<br /><em><br /><br />&#160;Converts a product name, record sequence tuple into a product name, sum total amount tuple.</em></div>
<div class="tip" id="fs26">val n : &#39;a</div>
<div class="tip" id="fs27">val p : seq&lt;&#39;b&gt;</div>
<div class="tip" id="fs28">Multiple items<br />val seq : sequence:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Core.Operators.seq<br /><br />--------------------<br />type seq&lt;&#39;T&gt; = Collections.Generic.IEnumerable&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.seq&lt;_&gt;</div>
<div class="tip" id="fs29">module Seq<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs30">val sumBy : projection:(&#39;T -&gt; &#39;U) -&gt; source:seq&lt;&#39;T&gt; -&gt; &#39;U (requires member ( + ) and member get_Zero)<br /><br />Full name: Microsoft.FSharp.Collections.Seq.sumBy</div>
<div class="tip" id="fs31">val d : &#39;b</div>
<div class="tip" id="fs32">val dateMax : _arg1:&#39;a -&gt; (&#39;b * &#39;c) option<br /><br />Full name: ExampleEmailReport.dateMax<br /><em><br /><br />&#160;Converts a record into a date, max amount tuple if it differs from the average amount.</em></div>
<div class="tip" id="fs33">val d : &#39;a</div>
<div class="tip" id="fs34">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs35">union case Option.None: Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs36">val dateStDev : _arg1:&#39;a -&gt; (&#39;b * float) option<br /><br />Full name: ExampleEmailReport.dateStDev<br /><em><br /><br />&#160;Converts a record into a date, standard deviation of amount tuple if one exists.</em></div>
<div class="tip" id="fs37">Multiple items<br />val float : value:&#39;T -&gt; float (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.float<br /><br />--------------------<br />type float = Double<br /><br />Full name: Microsoft.FSharp.Core.float<br /><br />--------------------<br />type float&lt;&#39;Measure&gt; = float<br /><br />Full name: Microsoft.FSharp.Core.float&lt;_&gt;</div>
<div class="tip" id="fs38">val dateAvg : d:&#39;a -&gt; &#39;b * &#39;c<br /><br />Full name: ExampleEmailReport.dateAvg<br /><em><br /><br />&#160;Converts a record into a date, average amount tuple.</em></div>
<div class="tip" id="fs39">val products : seq&lt;obj * seq&lt;obj&gt;&gt;<br /><br />Full name: ExampleEmailReport.products<br /><em><br /><br />&#160;Collects the records by product name, caching to prevent re-reading from a closed data reader.</em></div>
<div class="tip" id="fs40">val cache : source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.cache</div>
<div class="tip" id="fs41">val groupBy : projection:(&#39;T -&gt; &#39;Key) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;Key * seq&lt;&#39;T&gt;&gt; (requires equality)<br /><br />Full name: Microsoft.FSharp.Collections.Seq.groupBy</div>
<div class="tip" id="fs42">val o : obj</div>
<div class="tip" id="fs43">val saveChart : c:&#39;a -&gt; LinkedResource<br /><br />Full name: ExampleEmailReport.saveChart<br /><em><br /><br />&#160;Saves a chart to a temporary file, and returns a LinkedResource object for emailing.</em></div>
<div class="tip" id="fs44">val c : &#39;a</div>
<div class="tip" id="fs45">val file : string</div>
<div class="tip" id="fs46">IO.Path.ChangeExtension(path: string, extension: string) : string</div>
<div class="tip" id="fs47">IO.Path.GetTempFileName() : string</div>
<div class="tip" id="fs48">val ignore : value:&#39;T -&gt; unit<br /><br />Full name: Microsoft.FSharp.Core.Operators.ignore</div>
<div class="tip" id="fs49">Multiple items<br />type LinkedResource =<br />&#160;&#160;inherit AttachmentBase<br />&#160;&#160;new : fileName:string -&gt; LinkedResource + 5 overloads<br />&#160;&#160;member ContentLink : Uri with get, set<br />&#160;&#160;static member CreateLinkedResourceFromString : content:string -&gt; LinkedResource + 2 overloads<br /><br />Full name: System.Net.Mail.LinkedResource<br /><br />--------------------<br />LinkedResource(fileName: string) : unit<br />LinkedResource(contentStream: IO.Stream) : unit<br />LinkedResource(fileName: string, mediaType: string) : unit<br />LinkedResource(fileName: string, contentType: ContentType) : unit<br />LinkedResource(contentStream: IO.Stream, mediaType: string) : unit<br />LinkedResource(contentStream: IO.Stream, contentType: ContentType) : unit</div>
<div class="tip" id="fs50">val charts : LinkedResource list<br /><br />Full name: ExampleEmailReport.charts<br /><em><br /><br />&#160;The collection of charts, as LinkResource objects for emailing.</em></div>
<div class="tip" id="fs51">val toList : source:seq&lt;&#39;T&gt; -&gt; &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.Seq.toList</div>
<div class="tip" id="fs52">Multiple items<br />module List<br /><br />from Microsoft.FSharp.Collections<br /><br />--------------------<br />type List&lt;&#39;T&gt; =<br />&#160;&#160;| ( [] )<br />&#160;&#160;| ( :: ) of Head: &#39;T * Tail: &#39;T list<br />&#160;&#160;interface IEnumerable<br />&#160;&#160;interface IEnumerable&lt;&#39;T&gt;<br />&#160;&#160;member GetSlice : startIndex:int option * endIndex:int option -&gt; &#39;T list<br />&#160;&#160;member Head : &#39;T<br />&#160;&#160;member IsEmpty : bool<br />&#160;&#160;member Item : index:int -&gt; &#39;T with get<br />&#160;&#160;member Length : int<br />&#160;&#160;member Tail : &#39;T list<br />&#160;&#160;static member Cons : head:&#39;T * tail:&#39;T list -&gt; &#39;T list<br />&#160;&#160;static member Empty : &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.List&lt;_&gt;</div>
<div class="tip" id="fs53">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; list:&#39;T list -&gt; &#39;U list<br /><br />Full name: Microsoft.FSharp.Collections.List.map</div>
<div class="tip" id="fs54">val p : obj</div>
<div class="tip" id="fs55">val o : seq&lt;obj&gt;</div>
<div class="tip" id="fs56">namespace System.Drawing</div>
<div class="tip" id="fs57">type Color =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;member A : byte<br />&#160;&#160;&#160;&#160;member B : byte<br />&#160;&#160;&#160;&#160;member Equals : obj:obj -&gt; bool<br />&#160;&#160;&#160;&#160;member G : byte<br />&#160;&#160;&#160;&#160;member GetBrightness : unit -&gt; float32<br />&#160;&#160;&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;&#160;&#160;member GetHue : unit -&gt; float32<br />&#160;&#160;&#160;&#160;member GetSaturation : unit -&gt; float32<br />&#160;&#160;&#160;&#160;member IsEmpty : bool<br />&#160;&#160;&#160;&#160;member IsKnownColor : bool<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: System.Drawing.Color</div>
<div class="tip" id="fs58">property Drawing.Color.Red: Drawing.Color</div>
<div class="tip" id="fs59">val choose : chooser:(&#39;T -&gt; &#39;U option) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.choose</div>
<div class="tip" id="fs60">property Drawing.Color.DarkOrange: Drawing.Color</div>
<div class="tip" id="fs61">property Drawing.Color.Blue: Drawing.Color</div>
<div class="tip" id="fs62">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.map</div>
<div class="tip" id="fs63">val append : list1:&#39;T list -&gt; list2:&#39;T list -&gt; &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.List.append</div>
<div class="tip" id="fs64">val sendCharts : t:string -&gt; s:string -&gt; c:LinkedResource list -&gt; unit<br /><br />Full name: ExampleEmailReport.sendCharts<br /><em><br /><br />&#160;Sends an email to the given address, with the given subject, using the LinkedResource <br />&#160;objects as inline images in the body of the message.</em></div>
<div class="tip" id="fs65">val t : string</div>
<div class="tip" id="fs66">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.Operators.string<br /><br />--------------------<br />type string = String<br /><br />Full name: Microsoft.FSharp.Core.string</div>
<div class="tip" id="fs67">val s : string</div>
<div class="tip" id="fs68">val c : LinkedResource list</div>
<div class="tip" id="fs69">val email : MailMessage<br /><em><br /><br />&#160;The email message, initialized with the subject value.<br />&#160;The default from address is set in machine.config&#39;s<br />&#160;/configuration/system.net/mailSettings/smtp/@from</em></div>
<div class="tip" id="fs70">Multiple items<br />type MailMessage =<br />&#160;&#160;new : unit -&gt; MailMessage + 3 overloads<br />&#160;&#160;member AlternateViews : AlternateViewCollection<br />&#160;&#160;member Attachments : AttachmentCollection<br />&#160;&#160;member Bcc : MailAddressCollection<br />&#160;&#160;member Body : string with get, set<br />&#160;&#160;member BodyEncoding : Encoding with get, set<br />&#160;&#160;member CC : MailAddressCollection<br />&#160;&#160;member DeliveryNotificationOptions : DeliveryNotificationOptions with get, set<br />&#160;&#160;member Dispose : unit -&gt; unit<br />&#160;&#160;member From : MailAddress with get, set<br />&#160;&#160;...<br /><br />Full name: System.Net.Mail.MailMessage<br /><br />--------------------<br />MailMessage() : unit<br />MailMessage(from: string, to: string) : unit<br />MailMessage(from: MailAddress, to: MailAddress) : unit<br />MailMessage(from: string, to: string, subject: string, body: string) : unit</div>
<div class="tip" id="fs71">property MailMessage.To: MailAddressCollection</div>
<div class="tip" id="fs72">Collections.ObjectModel.Collection.Add(item: MailAddress) : unit<br />MailAddressCollection.Add(addresses: string) : unit</div>
<div class="tip" id="fs73">val body : string<br /><em><br /><br />&#160;The HTML body of the email: inline images of the provided LinkedResource objects.</em></div>
<div class="tip" id="fs74">val i : LinkedResource</div>
<div class="tip" id="fs75">val sprintf : format:Printf.StringFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.sprintf</div>
<div class="tip" id="fs76">property AttachmentBase.ContentId: string</div>
<div class="tip" id="fs77">Multiple items<br />type String =<br />&#160;&#160;new : value:char -&gt; string + 7 overloads<br />&#160;&#160;member Chars : int -&gt; char<br />&#160;&#160;member Clone : unit -&gt; obj<br />&#160;&#160;member CompareTo : value:obj -&gt; int + 1 overload<br />&#160;&#160;member Contains : value:string -&gt; bool<br />&#160;&#160;member CopyTo : sourceIndex:int * destination:char[] * destinationIndex:int * count:int -&gt; unit<br />&#160;&#160;member EndsWith : value:string -&gt; bool + 2 overloads<br />&#160;&#160;member Equals : obj:obj -&gt; bool + 2 overloads<br />&#160;&#160;member GetEnumerator : unit -&gt; CharEnumerator<br />&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;...<br /><br />Full name: System.String<br /><br />--------------------<br />String(value: nativeptr&lt;char&gt;) : unit<br />String(value: nativeptr&lt;sbyte&gt;) : unit<br />String(value: char []) : unit<br />String(c: char, count: int) : unit<br />String(value: nativeptr&lt;char&gt;, startIndex: int, length: int) : unit<br />String(value: nativeptr&lt;sbyte&gt;, startIndex: int, length: int) : unit<br />String(value: char [], startIndex: int, length: int) : unit<br />String(value: nativeptr&lt;sbyte&gt;, startIndex: int, length: int, enc: Text.Encoding) : unit</div>
<div class="tip" id="fs78">val concat : sep:string -&gt; strings:seq&lt;string&gt; -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.String.concat</div>
<div class="tip" id="fs79">val view : AlternateView<br /><em><br /><br />&#160;Create the body as an AlternateView object, to support inline images.</em></div>
<div class="tip" id="fs80">Multiple items<br />type AlternateView =<br />&#160;&#160;inherit AttachmentBase<br />&#160;&#160;new : fileName:string -&gt; AlternateView + 5 overloads<br />&#160;&#160;member BaseUri : Uri with get, set<br />&#160;&#160;member LinkedResources : LinkedResourceCollection<br />&#160;&#160;static member CreateAlternateViewFromString : content:string -&gt; AlternateView + 2 overloads<br /><br />Full name: System.Net.Mail.AlternateView<br /><br />--------------------<br />AlternateView(fileName: string) : unit<br />AlternateView(contentStream: IO.Stream) : unit<br />AlternateView(fileName: string, mediaType: string) : unit<br />AlternateView(fileName: string, contentType: ContentType) : unit<br />AlternateView(contentStream: IO.Stream, mediaType: string) : unit<br />AlternateView(contentStream: IO.Stream, contentType: ContentType) : unit</div>
<div class="tip" id="fs81">AlternateView.CreateAlternateViewFromString(content: string) : AlternateView<br />AlternateView.CreateAlternateViewFromString(content: string, contentType: ContentType) : AlternateView<br />AlternateView.CreateAlternateViewFromString(content: string, contentEncoding: Text.Encoding, mediaType: string) : AlternateView</div>
<div class="tip" id="fs82">Multiple items<br />type ContentType =<br />&#160;&#160;new : unit -&gt; ContentType + 1 overload<br />&#160;&#160;member Boundary : string with get, set<br />&#160;&#160;member CharSet : string with get, set<br />&#160;&#160;member Equals : rparam:obj -&gt; bool<br />&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;member MediaType : string with get, set<br />&#160;&#160;member Name : string with get, set<br />&#160;&#160;member Parameters : StringDictionary<br />&#160;&#160;member ToString : unit -&gt; string<br /><br />Full name: System.Net.Mime.ContentType<br /><br />--------------------<br />ContentType() : unit<br />ContentType(contentType: string) : unit</div>
<div class="tip" id="fs83">type MediaTypeNames =<br />&#160;&#160;nested type Application<br />&#160;&#160;nested type Image<br />&#160;&#160;nested type Text<br /><br />Full name: System.Net.Mime.MediaTypeNames</div>
<div class="tip" id="fs84">type Text =<br />&#160;&#160;static val Plain : string<br />&#160;&#160;static val Html : string<br />&#160;&#160;static val Xml : string<br />&#160;&#160;static val RichText : string<br /><br />Full name: System.Net.Mime.MediaTypeNames.Text</div>
<div class="tip" id="fs85">field MediaTypeNames.Text.Html = &quot;text/html&quot;</div>
<div class="tip" id="fs86">val iter : action:(&#39;T -&gt; unit) -&gt; source:seq&lt;&#39;T&gt; -&gt; unit<br /><br />Full name: Microsoft.FSharp.Collections.Seq.iter</div>
<div class="tip" id="fs87">property AlternateView.LinkedResources: LinkedResourceCollection</div>
<div class="tip" id="fs88">Collections.ObjectModel.Collection.Add(item: LinkedResource) : unit</div>
<div class="tip" id="fs89">property MailMessage.AlternateViews: AlternateViewCollection</div>
<div class="tip" id="fs90">Collections.ObjectModel.Collection.Add(item: AlternateView) : unit</div>
<div class="tip" id="fs91">val send : SmtpClient<br /><em><br /><br />&#160;The SMTP sender, configured in the machine.config&#39;s<br />&#160;/configuration/system.net/mailSettings element.</em></div>
<div class="tip" id="fs92">Multiple items<br />type SmtpClient =<br />&#160;&#160;new : unit -&gt; SmtpClient + 2 overloads<br />&#160;&#160;member ClientCertificates : X509CertificateCollection<br />&#160;&#160;member Credentials : ICredentialsByHost with get, set<br />&#160;&#160;member DeliveryMethod : SmtpDeliveryMethod with get, set<br />&#160;&#160;member Dispose : unit -&gt; unit<br />&#160;&#160;member EnableSsl : bool with get, set<br />&#160;&#160;member Host : string with get, set<br />&#160;&#160;member PickupDirectoryLocation : string with get, set<br />&#160;&#160;member Port : int with get, set<br />&#160;&#160;member Send : message:MailMessage -&gt; unit + 1 overload<br />&#160;&#160;...<br /><br />Full name: System.Net.Mail.SmtpClient<br /><br />--------------------<br />SmtpClient() : unit<br />SmtpClient(host: string) : unit<br />SmtpClient(host: string, port: int) : unit</div>
<div class="tip" id="fs93">SmtpClient.Send(message: MailMessage) : unit<br />SmtpClient.Send(from: string, recipients: string, subject: string, body: string) : unit</div>

  </body>
  </html>
